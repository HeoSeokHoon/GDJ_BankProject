<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <!-- mapper namespace는 비우면 에러 -->
  <mapper namespace="com.winter.app.product.ReplyDAO">
  
  	<update id="setUpdate" parameterType="ReplyDTO">
  		UPDATE REPLY SET REPLYTEXT=#{replyText} WHERE REPLYNUM=#{replyNum}
  	</update>
  	<insert id="setReply" parameterType="ReplyDTO">
  		INSERT INTO REPLY VALUES(REPLY_SEQ.NEXTVAL, #{userName}, #{productNum}, #{replyText}, sysdate, #{replyJumsu})
  	</insert>
  	
  	<select id="getList" resultType="ReplyDTO" parameterType="Map">
  		SELECT * FROM
  			(SELECT ROWNUM RN, R.* FROM
  				(SELECT * FROM REPLY
				WHERE PRODUCTNUM=#{DTO.productNum}
			ORDER BY REPLYDATE ASC) R)
		WHERE RN BETWEEN #{pager.startRow} AND #{pager.lastRow}
  	</select>
  	
  	<select id="getTotalCount" parameterType="ReplyDTO" resultType="Long">
  		SELECT COUNT(REPLYNUM) FROM REPLY WHERE PRODUCTNUM=#{productNum}
  	</select>
  	
  	<delete id="setDelete" parameterType="ReplyDTO">
  		DELETE REPLY WHERE REPLYNUM=#{replyNum}
  	</delete>
  </mapper>